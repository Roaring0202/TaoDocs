<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Welcome to TaoEdu</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="Bittensor Documentation covers the usage, installation, and development of Bittensor.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Home</a></li><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> What is Bittensor?</a></li><li class="chapter-item expanded "><a href="generate_signature.html"><strong aria-hidden="true">2.</strong> Validator Signature</a></li><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">3.</strong> ReadMe</a></li><li class="chapter-item expanded "><a href="verify_signature.html"><strong aria-hidden="true">4.</strong> Verify Validator</a></li><li class="chapter-item expanded "><a href="gating_model.html"><strong aria-hidden="true">5.</strong> Gating Model</a></li><li class="chapter-item expanded "><a href="neuron.html"><strong aria-hidden="true">6.</strong> Neurons</a></li><li class="chapter-item expanded "><a href="rewards.html"><strong aria-hidden="true">7.</strong> Model Testing</a></li><li class="chapter-item expanded "><a href="client_commands.html"><strong aria-hidden="true">8.</strong> All the commands, but explained!</a></li><li class="chapter-item expanded "><a href="Bittensor_Init.html"><strong aria-hidden="true">9.</strong> Synopsis of Bittensor Code</a></li><li class="chapter-item expanded "><a href="core_validator_init.html"><strong aria-hidden="true">10.</strong> Core Validator Explanation</a></li><li class="chapter-item expanded "><a href="epochs.html"><strong aria-hidden="true">11.</strong> What's an Epoch?</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Welcome to TaoEdu</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>Hi, this is a community project supported by members of the Bittensor community.</p>
<p>In collaboration with community members on the Bittensor Network, as well by harnessing my own intellect, I have now begun to give detailed examples of what exactly is going on when we call the various functions of the Bittensor network. </p>
<p>Along with this, I have included further documentation and instruction on what linux commands you will want to know, as well as how to navigate through Unix/the basics of what you'll need to know about going forward if you are to build on the Bittensor Network. </p>
<p>The objective here is to dissect and analyze the knowledge found within Bittensor so that we may educate those who do not know, but in a way that's more translatable to the average person. </p>
<p>Although it will take much time and effort, Machine Learning is something that is quite enjoyable, and in the docs we also go over the way it is evolving with our Network. </p>
<p>This is meant to give a blueprint for workflow within the prompting Network, so although I have yet to access things, either contact my by pulling this repo or hit my line on Discord. I am willing to further my knowledge and begin understanding how prompting works if somebody is willing to teach me such things. </p>
<p>Here at TaoEdu, we are all learning. If you would like to band together with us as either a mining expert of validator with a vision of making this intelligence more accessible, then please, contact me. Thank you.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-bittensor"><a class="header" href="#what-is-bittensor">What is Bittensor?</a></h1>
<p>Bittensor is an internet-scale mining network that encourages miners to host and train machine learning models. The network uses token-based incentives to promote its growth and to distribute value directly to the individuals providing that value. Bittensor is an open network, accessible to all participants, and no individual or group has full control over its learning, profit generation, or access.</p>
<p>Some key features of Bittensor include:</p>
<ul>
<li>Querying the Bittensor network as a client</li>
<li>Running and building Bittensor miners and validators for mining TAO</li>
<li>Pulling network state information</li>
<li>Managing TAO wallets, balances, transfers, etc.</li>
</ul>
<h2 id="documentation-overview"><a class="header" href="#documentation-overview">Documentation Overview</a></h2>
<p>This documentation is divided into several sections to help you get started with Bittensor:</p>
<ol>
<li><strong>Introduction</strong>: An overview of Bittensor and its key features (this section)</li>
<li><strong>Installation</strong>: Step-by-step instructions for installing Bittensor</li>
<li><strong>Usage</strong>: Guides on how to use Bittensor as a client, miner, and validator</li>
<li><strong>API Reference</strong>: Detailed information on Bittensor's API and its various functions</li>
<li><strong>FAQs</strong>: Answers to frequently asked questions about Bittensor</li>
</ol>
<p>We hope you find this documentation helpful as you explore and use Bittensor. If you have any questions or need further assistance, please don't hesitate to reach out to the community on <a href="https://discord.gg/bittensor">Discord</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="validator-information-signing"><a class="header" href="#validator-information-signing">Validator Information Signing</a></h1>
<p>This script gathers information about a validator and creates a signed message for that information. The information includes the mnemonic of the validator's hotkey, a descriptive name, a URL, and a short description.</p>
<h2 id="process"><a class="header" href="#process">Process</a></h2>
<ol>
<li>Import the required libraries: <code>json</code> and <code>bittensor</code>.</li>
<li>Request user input for the following information:
<ul>
<li>Validator's hotkey mnemonic</li>
<li>Descriptive name for the validator</li>
<li>Validator URL</li>
<li>Short description for the validator</li>
</ul>
</li>
<li>Create a keypair from the mnemonic.</li>
<li>Create a dictionary with the validator's information.</li>
<li>Convert the dictionary to a JSON-formatted string.</li>
<li>Sign the JSON string using the keypair.</li>
<li>Verify the signature and print the results.</li>
</ol>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="bittensorkeypaircreate_from_mnemonicmnemonic"><a class="header" href="#bittensorkeypaircreate_from_mnemonicmnemonic">bittensor.Keypair.create_from_mnemonic(mnemonic)</a></h3>
<ul>
<li><strong>Description</strong>: Creates a keypair object from a given mnemonic.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>mnemonic</code> (str): The mnemonic string for the validator's hotkey.</li>
</ul>
</li>
<li><strong>Returns</strong>: A <code>bittensor.Keypair</code> object.</li>
</ul>
<h3 id="bittensorkeypairss58_address"><a class="header" href="#bittensorkeypairss58_address">bittensor.Keypair(ss58_address)</a></h3>
<ul>
<li><strong>Description</strong>: Initializes a keypair object with the given SS58 address.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>ss58_address</code> (str): The SS58 address of the keypair.</li>
</ul>
</li>
<li><strong>Returns</strong>: A <code>bittensor.Keypair</code> object.</li>
</ul>
<h3 id="keypairsigndata"><a class="header" href="#keypairsigndata">keypair.sign(data)</a></h3>
<ul>
<li><strong>Description</strong>: Signs a message (data) using the keypair.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>data</code> (str): The message to be signed.</li>
</ul>
</li>
<li><strong>Returns</strong>: A signature string.</li>
</ul>
<h3 id="bittensorkeypairverifydata-signature"><a class="header" href="#bittensorkeypairverifydata-signature">bittensor.Keypair.verify(data, signature)</a></h3>
<ul>
<li><strong>Description</strong>: Verifies the signature of a signed message using the keypair.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>data</code> (str): The original message that was signed.</li>
<li><code>signature</code> (str): The signature of the message.</li>
</ul>
</li>
<li><strong>Returns</strong>: A boolean value indicating whether the signature is valid (<code>True</code>) or not (<code>False</code>).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><p>Hi, this is a community project supported by members of the Bittensor community.</p>
<p>In collaboration with community members on the Bittensor Network, as well by harnessing my own intellect, I have now begun to give detailed examples of what exactly is going on when we call the various functions of the Bittensor network. </p>
<p>Along with this, I have included further documentation and instruction on what linux commands you will want to know, as well as how to navigate through Unix/the basics of what you'll need to know about going forward if you are to build on the Bittensor Network. </p>
<p>The objective here is to dissect and analyze the knowledge found within Bittensor so that we may educate those who do not know, but in a way that's more translatable to the average person. </p>
<p>Although it will take much time and effort, Machine Learning is something that is quite enjoyable, and in the docs we also go over the way it is evolving with our Network. </p>
<p>This is meant to give a blueprint for workflow within the prompting Network, so although I have yet to access things, either contact my by pulling this repo or hit my line on Discord. I am willing to further my knowledge and begin understanding how prompting works if somebody is willing to teach me such things. </p>
<p>Here at TaoEdu, we are all learning. If you would like to band together with us as either a mining expert of validator with a vision of making this intelligence more accessible, then please, contact me. Thank you.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="verify-validator"><a class="header" href="#verify-validator">Verify Validator</a></h1>
<p>This script verifies the validator's signed information provided by the user. The user needs to input the validator information and the validator signature.</p>
<h2 id="process-1"><a class="header" href="#process-1">Process</a></h2>
<ol>
<li>Import the required libraries: <code>json</code>, <code>bittensor</code>, and <code>binascii</code>.</li>
<li>Request user input for the following information:
<ul>
<li>Validator information</li>
<li>Validator signature</li>
</ul>
</li>
<li>Convert the signature from hexadecimal to binary.</li>
<li>Create a keypair using the validator's SS58 address.</li>
<li>Verify the signature using the keypair and print the results.</li>
</ol>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="bittensorkeypairss58_address-1"><a class="header" href="#bittensorkeypairss58_address-1">bittensor.Keypair(ss58_address)</a></h3>
<ul>
<li><strong>Description</strong>: Initializes a keypair object with the given SS58 address.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>ss58_address</code> (str): The SS58 address of the keypair.</li>
</ul>
</li>
<li><strong>Returns</strong>: A <code>bittensor.Keypair</code> object.</li>
</ul>
<h3 id="binasciiunhexlifydata"><a class="header" href="#binasciiunhexlifydata">binascii.unhexlify(data)</a></h3>
<ul>
<li><strong>Description</strong>: Converts a hexadecimal string to binary data.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>data</code> (str): The hexadecimal string to be converted.</li>
</ul>
</li>
<li><strong>Returns</strong>: Binary data.</li>
</ul>
<h3 id="keypairverifydata-signature"><a class="header" href="#keypairverifydata-signature">keypair.verify(data, signature)</a></h3>
<ul>
<li><strong>Description</strong>: Verifies the signature of a signed message using the keypair.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>data</code> (str): The original message that was signed.</li>
<li><code>signature</code> (str): The signature of the message.</li>
</ul>
</li>
<li><strong>Returns</strong>: A boolean value indicating whether the signature is valid (<code>True</code>) or not (<code>False</code>).</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gating-model-high-level-over-view"><a class="header" href="#gating-model-high-level-over-view">Gating model High Level Over-view</a></h1>
<p>This file defines a GatingModel class, which is a PyTorch module designed for the Bittensor network. At a high level, the class is responsible for encoding input messages, generating scores for each unique identifier (uid) in the network, and updating the model based on mean squared error loss between the normalized scores and normalized rewards.</p>
<p>The GatingModel class leverages a pre-trained transformer-based language model as its encoding layer. It then applies a linear layer to generate scores for each uid. To optimize the model, it uses the stochastic gradient descent (SGD) algorithm with configurable learning rate and momentum.</p>
<p>To use the class, a user needs to create an instance of GatingModel, providing necessary configuration details, such as the pre-trained model name and number of uids. Once the instance is created, the user can call the forward method to obtain scores for a given input message and use the backward method to update the model based on rewards obtained from the network.</p>
<p>Overall, this file provides a flexible and configurable solution for creating and updating a gating model that can be easily integrated into the Bittensor network.</p>
<h2 id="this-chapter-explains-the-gatingmodel-class-which-is-a-pytorch-module-for-creating-a-gating-model-in-the-bittensor-network-the-main-functions-of-this-module-are"><a class="header" href="#this-chapter-explains-the-gatingmodel-class-which-is-a-pytorch-module-for-creating-a-gating-model-in-the-bittensor-network-the-main-functions-of-this-module-are">This chapter explains the GatingModel class, which is a PyTorch module for creating a gating model in the Bittensor network. The main functions of this module are:</a></h2>
<p>Encoding input messages and generating scores for each unique identifier (uid) in the network.
Running a backward pass through the model using mean squared error between normalized scores and normalized rewards as the loss function.</p>
<h3 id="methods"><a class="header" href="#methods">Methods</a></h3>
<p>• add_args: Adds command line arguments to configure the gating model.
• config: Returns a configuration object containing the command line arguments for the gating model.
• check_config: Validates the configuration object for the gating model.
• init: Initializes the gating model. 
• backward: Runs a backward pass through the model.
• forward: Runs a forward pass through the model, encoding the input message and generating scores for each uid in the network.</p>
<p><code>def add_args(cls, parser: argparse.ArgumentParser)</code></p>
<h3 id="usage"><a class="header" href="#usage">Usage</a></h3>
<p>The module uses a pre-trained transformer-based language model as the encoding layer and a linear layer to generate scores for each uid. The model is optimized using the stochastic gradient descent (SGD) algorithm.</p>
<p>To use the gating model, a user would first create an instance of the GatingModel class with the desired configuration and then run the forward and backward methods for their specific use case.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="code-summary"><a class="header" href="#code-summary">Code Summary</a></h1>
<p>This Python script defines a class called <code>neuron</code> that acts as a core component in a distributed machine learning network. It is responsible for managing the network communication, the model training, and the reward distribution among peers.</p>
<h2 id="key-components"><a class="header" href="#key-components">Key Components</a></h2>
<h3 id="constants"><a class="header" href="#constants">Constants</a></h3>
<ul>
<li><code>__default_question_prompt__</code>: The default prompt used for generating questions from the network to evaluate other miners.</li>
<li><code>__default_base_prompt__</code>: The default base prompt injected before a question is completed by miners on the network.</li>
</ul>
<h3 id="class-definition-neuron"><a class="header" href="#class-definition-neuron">Class Definition: neuron</a></h3>
<p>This class is responsible for initializing and managing the network communication, model training, and reward distribution among the peers.</p>
<h4 id="methods-1"><a class="header" href="#methods-1">Methods:</a></h4>
<ul>
<li><code>check_config(cls, config)</code>: Validates the config namespace object and sets up the directories required for logging and reward models.</li>
<li><code>record_event(self, event)</code>: Records a forward event in the history queue and logs the event if specified in the config.</li>
<li><code>add_args(cls, parser)</code>: Adds the command-line arguments required for the neuron configuration.</li>
<li><code>config(cls)</code>: Generates the configuration object using the command-line arguments.</li>
<li><code>__init__(self)</code>: Initializes the neuron instance with the required components like subtensor, wallet, metagraph, tokenizer, reward model, gating model, dendrite pool, history queue, and axon.</li>
</ul>
<h4 id="forward-method"><a class="header" href="#forward-method">Forward Method:</a></h4>
<ul>
<li><code>forward(self, roles, messages, topk, random_sample_uids, train_gating_model, train_network, timeout)</code>: Queries the network for a response to the passed message using a gating model to select the best uids. Trains the gating model based on the rewards calculated for the successful completions and passes rewards backward for potential PPO.</li>
</ul>
<h2 id="execution-flow"><a class="header" href="#execution-flow">Execution Flow</a></h2>
<p>The script initializes a <code>neuron</code> instance and starts the network communication and model training. The neuron class takes care of the communication with other peers in the network and manages the mining process.</p>
<h3 id="additional-methods"><a class="header" href="#additional-methods">Additional Methods</a></h3>
<h4 id="inferenceself-messages-listdictstr-str---str"><a class="header" href="#inferenceself-messages-listdictstr-str---str">inference(self, messages: List[Dict[str, str]]) -&gt; str</a></h4>
<ul>
<li>Logs the inference process.</li>
<li>Pre-processes the messages to extract roles and contents.</li>
<li>Gets scores for the query from the gating model.</li>
<li>Gets uids for the query based on the scores.</li>
<li>Queries the network using the dendrite pool.</li>
<li>Applies the reward model to choose the best completion from the responses.</li>
<li>Returns the best completion.</li>
</ul>
<h4 id="trainself"><a class="header" href="#trainself">train(self)</a></h4>
<ul>
<li>Runs an infinite loop for training.
<ul>
<li>Queries the network for a random question and saves it.</li>
<li>Asks the network to complete the random question while training the gating network.</li>
<li>Syncs the metagraph and updates nominators.</li>
<li>Computes and sets the weights on the blockchain.</li>
</ul>
</li>
</ul>
<h4 id="compute_weightsself---tupletorchlongtensor-torchfloattensor"><a class="header" href="#compute_weightsself---tupletorchlongtensor-torchfloattensor">compute_weights(self) -&gt; Tuple[torch.LongTensor, torch.FloatTensor]</a></h4>
<ul>
<li>Computes the average reward for each uid across non-zero values using the rewards history.</li>
<li>Normalizes the rewards with a softmax and performs a moving average of the normalized rewards.</li>
<li>If the hotkeys have changed, resets the moving averaged scores for the new hotkeys.</li>
<li>Calculates the average reward for each uid across non-zero values.</li>
<li>Processes the raw weights to final_weights via subtensor limitations.</li>
<li>Returns the processed weights and uids.</li>
</ul>
<h3 id="execution-flow-1"><a class="header" href="#execution-flow-1">Execution Flow</a></h3>
<p>When the script is run, it initializes a <code>neuron</code> instance and enters an infinite loop, periodically calling the <code>train()</code> method to train the model and update the weights on the blockchain.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-rewards-work"><a class="header" href="#how-rewards-work">How Rewards Work</a></h1>
<h4 id="it-should-be-stated-that-this-is-an-llms-interpretation-and-has-yet-to-been-altered-much-if-at-all-by-a-human-ill-remove-this-note-later-ill-double-check-all-files-before-i-push-the-final-version-of-them"><a class="header" href="#it-should-be-stated-that-this-is-an-llms-interpretation-and-has-yet-to-been-altered-much-if-at-all-by-a-human-ill-remove-this-note-later-ill-double-check-all-files-before-i-push-the-final-version-of-them"><em>It should be stated that this is an LLMs interpretation and has yet to been altered much, if at all, by a human. I'll remove this note later, I'll double check all files before I push the final version of them.</em></a></h4>
<p>This code defines a <code>RewardModel</code> class that inherits from <code>torch.nn.Module</code>. The <code>RewardModel</code> is used to calculate rewards for completions generated by a language model.</p>
<ol>
<li>
<p><code>__init__</code> method initializes the class with <code>model_path</code>, <code>device</code>, and <code>config</code> as arguments. It loads the pre-trained GPT model and tokenizer from the given model path. It also initializes the linear head <code>v_head</code> and sets the padding token.</p>
</li>
<li>
<p><code>reward</code> method computes rewards for a list of completions. It takes a list of completions and returns a tensor of rewards for each completion.</p>
</li>
<li>
<p><code>forward</code> method computes the forward pass of the model. It takes input tensors such as <code>input_ids</code>, <code>attention_mask</code>, etc., and returns a dictionary containing the loss, chosen end scores, and rejected end scores.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="btcli-guide"><a class="header" href="#btcli-guide">Btcli Guide</a></h1>
<h4 id="i-assume-most-people-who-use-bittensor-frequently-probably-know-what-these-commands-are-but-if-youre-completely-new-to-this-project-these-are-pretty-important"><a class="header" href="#i-assume-most-people-who-use-bittensor-frequently-probably-know-what-these-commands-are-but-if-youre-completely-new-to-this-project-these-are-pretty-important"><em>I assume most people who use Bittensor frequently probably know what these commands are, but if you're completely new to this project, these are pretty important.</em></a></h4>
<ul>
<li>
<p>btcli (insert command) will help you navigate through the network, have this open so you don't have to call -h over and over again. </p>
</li>
<li>
<p>list                List wallets</p>
</li>
<li>
<p>stake               Stake to your hotkey accounts.</p>
</li>
<li>
<p>update              Update bittensor</p>
</li>
<li>
<p>inspect             Inspect a wallet (cold, hot) pair</p>
</li>
<li>
<p>weights             Show weights from chain.</p>
</li>
<li>
<p>unstake             Unstake from hotkey accounts.</p>
</li>
<li>
<p>overview            Show registered account overview.</p>
</li>
<li>
<p>register            Register a wallet to a network.</p>
</li>
<li>
<p>transfer            Transfer Tao between accounts.</p>
</li>
<li>
<p>nominate            Become a delegate on the network</p>
</li>
<li>
<p>new_hotkey          Creates a new hotkey (for running a miner) under the specified path.</p>
</li>
<li>
<p>metagraph           Metagraph commands</p>
</li>
<li>
<p>set_weights         Setting weights on the chain.</p>
</li>
<li>
<p>new_coldkey         Creates a new coldkey (for containing balance) under the specified path.</p>
</li>
<li>
<p>new_hotkey          Creates a new hotkey (for running a miner) under the specified path.</p>
</li>
<li>
<p>my_delegates        Show all delegates where I am delegating a positive amount of stake</p>
</li>
<li>
<p>list_subnets        List all subnets on the network</p>
</li>
<li>
<p>regen_hotkey        Regenerates a hotkey from a passed mnemonic</p>
</li>
<li>
<p>regen_coldkey       Regenerates a coldkey from a passed value</p>
</li>
<li>
<p>delegate            Delegate Stake to an account.</p>
</li>
<li>
<p>undelegate          Undelegate Stake from an account.</p>
</li>
<li>
<p>list_delegates      List all delegates on the network</p>
</li>
<li>
<p>regen_coldkeypub    Regenerates a coldkeypub from the public part of the coldkey.</p>
</li>
<li>
<p>recycle_register    Register a wallet to a network.</p>
</li>
</ul>
<h3 id="example-commands-you-may-use-a-lot-if-you-are-going-to-run-a-miner-for-instance-may-be-these"><a class="header" href="#example-commands-you-may-use-a-lot-if-you-are-going-to-run-a-miner-for-instance-may-be-these">Example commands you may use a lot, if you are going to run a miner for instance may be these:</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="synopsis-of-bittensor-code"><a class="header" href="#synopsis-of-bittensor-code">Synopsis of Bittensor Code</a></h1>
<p>This module includes components for Bittensor, a decentralized AI network. Key components include versioning, rich console setup, functions for controlling the console, constants, and Prometheus setup.</p>
<h2 id="key-components-1"><a class="header" href="#key-components-1">Key Components</a></h2>
<ul>
<li><strong>Versioning</strong>: The code uses semantic versioning with a format like <code>4.0.1</code>.</li>
<li><strong>Rich Console Setup</strong>: The rich console is set up to display output in a more visually appealing manner.</li>
<li><strong>Console Control</strong>: A function <code>turn_console_off</code> is provided to turn off the rich console output.</li>
<li><strong>Constants</strong>: Various constants are defined, such as network dimensions, block time, SS58 format, dataset names, entry points, and network explorer map.</li>
<li><strong>Prometheus Setup</strong>: The code sets up Prometheus for monitoring with a version like <code>0.1.0</code>.</li>
</ul>
<h2 id="example-usage"><a class="header" href="#example-usage">Example Usage</a></h2>
<p>The Bittensor code can be used to create and interact with a decentralized AI network. This includes managing the network components, dataset handling, and communication with the Substrate blockchain.</p>
<p>Please note that the actual implementation details, such as importing required classes and setting up default configurations, have been omitted from this summary for brevity.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="core-validator-py-analysis"><a class="header" href="#core-validator-py-analysis"><strong>Core Validator .py Analysis</strong></a></h1>
<h3 id="it-is-important-to-note-here-that-i-have-no-idea-about-the-accuracy-of-statements-of-this-and-i-couldnt-explain-what-the-code-actually-does-in-fact-i-didnt-if-it-seems-inaccurate-to-you-then-tell-me-and-i-can-correct-it"><a class="header" href="#it-is-important-to-note-here-that-i-have-no-idea-about-the-accuracy-of-statements-of-this-and-i-couldnt-explain-what-the-code-actually-does-in-fact-i-didnt-if-it-seems-inaccurate-to-you-then-tell-me-and-i-can-correct-it"><em><strong>It is important to note here that I have no idea about the accuracy of statements of this, and I couldn't explain what the code actually does. In fact, I didn't. If it seems inaccurate to you, then tell me and I can correct it.</strong></em></a></h3>
<h2 id="the-code-revolves-around-the-following-concepts"><a class="header" href="#the-code-revolves-around-the-following-concepts">The code revolves around the following concepts:</a></h2>
<blockquote>
<p>Querying multiple machine learning models (endpoints) and aggregating their predictions.
Calculating Shapley values and Shapley synergies to evaluate the contributions of each model in a coalition.
Formatting the predictions and logging results for a better understanding of model performance and interactions.</p>
</blockquote>
<h2 id="the-main-functions-of-the-code-can-be-summarized-as-follows"><a class="header" href="#the-main-functions-of-the-code-can-be-summarized-as-follows">The main functions of the code can be summarized as follows:</a></h2>
<blockquote>
<p>query function: Sends queries to multiple endpoints (models), collects their responses, and returns the aggregated results along with endpoint statistics.
shapley function: Calculates Shapley values based on endpoint statistics and the loss values of each model in a coalition.
shapley_synergy function: Calculates Shapley synergies for coalitions of size 2, measuring the performance improvement over expected individual model performance.
format_predictions function: Formats the batch task top-k predictions for a rich table print of query responses.
unsuccess function: Prints the return codes and response times of unsuccessful responses.</p>
</blockquote>
<h2 id="overall-the-purpose-of-this-python-file-is-to-handle-interactions-between-multiple-machine-learning-models-evaluate-their-performance-and-contributions-to-a-coalition-and-format-the-results-for-better-understanding-and-visualization"><a class="header" href="#overall-the-purpose-of-this-python-file-is-to-handle-interactions-between-multiple-machine-learning-models-evaluate-their-performance-and-contributions-to-a-coalition-and-format-the-results-for-better-understanding-and-visualization">Overall, the purpose of this Python file is to handle interactions between multiple machine learning models, evaluate their performance and contributions to a coalition, and format the results for better understanding and visualization.</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="what-is-an-epoch"><a class="header" href="#what-is-an-epoch">What is an Epoch?</a></h1>
<h2 id="epochs-in-bittensor-network"><a class="header" href="#epochs-in-bittensor-network">Epochs in Bittensor Network</a></h2>
<p>Epochs in the context of the Bittensor network are used to manage the update and synchronization process of the network's state, including the weights of the neurons (network participants). Each epoch represents a time period during which the network participants train their models, exchange information, and update their local states. At the end of an epoch, the updated weights are submitted to the network, and a new epoch begins.</p>
<p>In Bittensor, the concept of epochs serves several purposes:</p>
<h3 id="1-synchronization"><a class="header" href="#1-synchronization">1. Synchronization</a></h3>
<p>Epochs help synchronize the state of the network. By having a fixed time period during which participants can train their models and exchange information, the network ensures that all nodes have a chance to update their local states before the next epoch begins.</p>
<h3 id="2-weight-updates"><a class="header" href="#2-weight-updates">2. Weight updates</a></h3>
<p>At the end of each epoch, the updated weights are submitted to the network, which helps maintain the global state and improve the overall performance of the network.</p>
<h3 id="3-incentivization"><a class="header" href="#3-incentivization">3. Incentivization</a></h3>
<p>Bittensor uses a staking mechanism to incentivize network participants. By participating in the network and submitting their weights at the end of each epoch, participants can earn rewards in the form of tokens.</p>
<h3 id="4-decentralization"><a class="header" href="#4-decentralization">4. Decentralization</a></h3>
<p>By dividing the network's operation into epochs, Bittensor ensures that no single participant has control over the entire network. This promotes decentralization and helps maintain the network's security and stability.</p>
<p>In summary, epochs in the Bittensor network are used to manage the update process, synchronize the network's state, incentivize participants, and promote decentralization.</p>
<h2 id="function-run_epoch"><a class="header" href="#function-run_epoch">Function: <code>run_epoch</code></a></h2>
<p>The <code>run_epoch</code> function executes a single validator epoch. It applies batches until the epoch length is exhausted. Occasionally, the validator nucleus is reset to ensure it doesn't converge too far. At the end of the epoch, weights are set on the chain and optionally logged to wandb.</p>
<h4 id="code-explanation"><a class="header" href="#code-explanation">Code Explanation</a></h4>
<ol>
<li>
<p>Get parameters for the epoch depending on the selected network (either 'nakamoto' or 'finney'). Parameters include batch_size, sequence_length, prune_len, logits_divergence, min_allowed_weights, max_weight_limit, scaling_law_power, and synergy_scaling_law_power.</p>
</li>
<li>
<p>Update the dataset size based on the calculated batch_size, sequence_length, and validation_len.</p>
</li>
<li>
<p>Run the epoch:
a. Initialize epoch-related variables like epoch_steps, epoch_responsive_uids, epoch_queried_uids, and epoch_start_time.
b. Log the start of the epoch using wandb and prometheus.
c. Run a loop until either the block count or the time limit is reached.
i.   Log the current state of the epoch.
ii.  Perform a forward pass through the network and calculate the loss and endpoint scores.
iii. Perform a backward pass if the loss has a gradient.
iv.  Update neuron stats, responsive_uids, and queried_uids.
v.   Update the state of the epoch, including the global_step and current_block.
vi.  Perform optimization steps.
vii. Log the state of the epoch using console messages, console tables, prometheus, and wandb.
viii.Reset the metagraph.</p>
</li>
<li>
<p>Calculate neuron weights at the end of the epoch.</p>
</li>
<li>
<p>Set weights on the chain using the calculated weights.</p>
</li>
<li>
<p>Log the end of the epoch using console messages, console tables, prometheus, and wandb.</p>
</li>
<li>
<p>Increment the epoch counter.</p>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
